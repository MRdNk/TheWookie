var pg = require('pg')
var applications = require('./applications.js')
var sites = require('./sites.js')

function postgres_wookie (opts) {
  var that = this

  var opts = opts || {}
  var connstring = require('./db_connstring.js')(opts)

  var clientHolder = function () { return new pg.Client(connstring) }
  // var clientHolder = new pg.Client(connstring)
  
  return {
      application: applications(clientHolder)
    , sites: sites(clientHolder)
  }

}

module.exports = postgres_wookie;